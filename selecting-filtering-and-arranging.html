<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Chapter 6 Selecting, Filtering, and Arranging | Baseball Analytics Workshop (Morning Session)</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook.">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="Chapter 6 Selecting, Filtering, and Arranging | Baseball Analytics Workshop (Morning Session)" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Selecting, Filtering, and Arranging | Baseball Analytics Workshop (Morning Session)" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Charles Redmond">


<meta name="date" content="2019-03-21">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="install-dplyr.html">
<link rel="next" href="grouping.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Baseball Analytics Workshop</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Software Installation</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#install-r"><i class="fa fa-check"></i><b>1.1</b> Install R</a><ul>
<li class="chapter" data-level="1.1.1" data-path="index.html"><a href="index.html#windows"><i class="fa fa-check"></i><b>1.1.1</b> Windows</a></li>
<li class="chapter" data-level="1.1.2" data-path="index.html"><a href="index.html#mac"><i class="fa fa-check"></i><b>1.1.2</b> Mac</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#rstudio"><i class="fa fa-check"></i><b>1.2</b> RStudio</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="intro-to-rstudio.html"><a href="intro-to-rstudio.html"><i class="fa fa-check"></i><b>2</b> Intro to RStudio</a></li>
<li class="chapter" data-level="3" data-path="install-lahman.html"><a href="install-lahman.html"><i class="fa fa-check"></i><b>3</b> Install Lahman</a></li>
<li class="chapter" data-level="4" data-path="a-look-at-the-tables.html"><a href="a-look-at-the-tables.html"><i class="fa fa-check"></i><b>4</b> A Look At The Tables</a></li>
<li class="chapter" data-level="5" data-path="install-dplyr.html"><a href="install-dplyr.html"><i class="fa fa-check"></i><b>5</b> Install dplyr</a></li>
<li class="chapter" data-level="6" data-path="selecting-filtering-and-arranging.html"><a href="selecting-filtering-and-arranging.html"><i class="fa fa-check"></i><b>6</b> Selecting, Filtering, and Arranging</a><ul>
<li class="chapter" data-level="6.1" data-path="selecting-filtering-and-arranging.html"><a href="selecting-filtering-and-arranging.html#select"><i class="fa fa-check"></i><b>6.1</b> Select</a></li>
<li class="chapter" data-level="6.2" data-path="selecting-filtering-and-arranging.html"><a href="selecting-filtering-and-arranging.html#scripts"><i class="fa fa-check"></i><b>6.2</b> Scripts</a></li>
<li class="chapter" data-level="6.3" data-path="selecting-filtering-and-arranging.html"><a href="selecting-filtering-and-arranging.html#filter"><i class="fa fa-check"></i><b>6.3</b> Filter</a></li>
<li class="chapter" data-level="6.4" data-path="selecting-filtering-and-arranging.html"><a href="selecting-filtering-and-arranging.html#arrange"><i class="fa fa-check"></i><b>6.4</b> Arrange</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="grouping.html"><a href="grouping.html"><i class="fa fa-check"></i><b>7</b> Grouping</a><ul>
<li class="chapter" data-level="7.1" data-path="grouping.html"><a href="grouping.html#the-basics"><i class="fa fa-check"></i><b>7.1</b> The Basics</a></li>
<li class="chapter" data-level="7.2" data-path="grouping.html"><a href="grouping.html#exercise"><i class="fa fa-check"></i><b>7.2</b> Exercise</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Baseball Analytics Workshop (Morning Session)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="selecting-filtering-and-arranging" class="section level1">
<h1><span class="header-section-number">Chapter 6</span> Selecting, Filtering, and Arranging</h1>
<div id="select" class="section level2">
<h2><span class="header-section-number">6.1</span> Select</h2>
<p>With <strong>dplyr</strong>, instead of seeing every column from a table, we may select the particular columns we are interested in. Type the following in the console and press enter:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bdat &lt;-<span class="st"> </span>Batting <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(playerID,yearID,teamID,HR)</code></pre></div>
<p>Now type</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(bdat,<span class="dv">10</span>)</code></pre></div>
<pre><code>##     playerID yearID teamID HR
## 1  abercda01   1871    TRO  0
## 2   addybo01   1871    RC1  0
## 3  allisar01   1871    CL1  0
## 4  allisdo01   1871    WS3  2
## 5  ansonca01   1871    RC1  0
## 6  armstbo01   1871    FW1  0
## 7  barkeal01   1871    RC1  0
## 8  barnero01   1871    BS1  0
## 9  barrebi01   1871    FW1  0
## 10 barrofr01   1871    BS1  0</code></pre>
<p>Let’s see what is happening here. The <strong>select</strong> verb of dplyr allows you to select the columns you want to see. However, we need to indicate the data frame from which we wish to select. (What we have been calling “tables” are actually called “data frames” in R, so we will use that terminology from now on.) We use the symbol <strong>%%</strong> to pipe the <strong>Batting</strong> data frame into the <strong>select</strong> function. We store the result into a variable we have called <strong>bdat</strong>, a generic variable name for baseball data. <strong>bdat</strong> is now a data frame with just the four columns we have chosen. We view the first few rows of <strong>bdat</strong> with the <strong>head</strong> function.</p>
</div>
<div id="scripts" class="section level2">
<h2><span class="header-section-number">6.2</span> Scripts</h2>
<p>It’s time now to make use of the source panel. We will write our code in the source panel and then run it in the console. Let’s do the example above again, but we will try it this new way. Type the following in the source panel:</p>
<p><img src="script1.png" /></p>
<p>To run your code, select it and then click the <strong>Run</strong> icon:</p>
<p><img src="script2.png" /></p>
<p>From now on, we will run all of our code this way.</p>
</div>
<div id="filter" class="section level2">
<h2><span class="header-section-number">6.3</span> Filter</h2>
<p>You will almost always want to see a subset of the records in a data frame intead of all of them. For instance, we may wish to see just the records where the HR value is 50 or more. For this, we can use the <strong>filter</strong> verb of dplyr. Type this code in the source panel and run it:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bdat &lt;-<span class="st"> </span>Batting <span class="op">%&gt;%</span>
<span class="st">          </span><span class="kw">filter</span>(HR <span class="op">&gt;=</span><span class="st"> </span><span class="dv">50</span>) <span class="op">%&gt;%</span>
<span class="st">          </span><span class="kw">select</span>(playerID,yearID,teamID,HR)

bdat</code></pre></div>
<pre><code>##     playerID yearID teamID HR
## 1   ruthba01   1920    NYA 54
## 2   ruthba01   1921    NYA 59
## 3   ruthba01   1927    NYA 60
## 4   ruthba01   1928    NYA 54
## 5  wilsoha01   1930    CHN 56
## 6   foxxji01   1932    PHA 58
## 7   foxxji01   1938    BOS 50
## 8  greenha01   1938    DET 58
## 9  kinerra01   1947    PIT 51
## 10  mizejo01   1947    NY1 51
## 11 kinerra01   1949    PIT 54
## 12  mayswi01   1955    NY1 51
## 13 mantlmi01   1956    NYA 52
## 14 mantlmi01   1961    NYA 54
## 15 marisro01   1961    NYA 61
## 16  mayswi01   1965    SFN 52
## 17 fostege01   1977    CIN 52
## 18 fieldce01   1990    DET 51
## 19 belleal01   1995    CLE 50
## 20 anderbr01   1996    BAL 50
## 21 mcgwima01   1996    OAK 52
## 22 griffke02   1997    SEA 56
## 23 griffke02   1998    SEA 56
## 24 mcgwima01   1998    SLN 70
## 25  sosasa01   1998    CHN 66
## 26 vaughgr01   1998    SDN 50
## 27 mcgwima01   1999    SLN 65
## 28  sosasa01   1999    CHN 63
## 29  sosasa01   2000    CHN 50
## 30 bondsba01   2001    SFN 73
## 31 gonzalu01   2001    ARI 57
## 32 rodrial01   2001    TEX 52
## 33  sosasa01   2001    CHN 64
## 34 rodrial01   2002    TEX 57
## 35 thomeji01   2002    CLE 52
## 36 jonesan01   2005    ATL 51
## 37 howarry01   2006    PHI 58
## 38 ortizda01   2006    BOS 54
## 39 fieldpr01   2007    MIL 50
## 40 rodrial01   2007    NYA 54
## 41 bautijo02   2010    TOR 54
## 42 davisch02   2013    BAL 53</code></pre>
<p>Note how we <strong>filter</strong> and then pipe the result into <strong>select</strong>. Note also that we did not use the <strong>head</strong> function to view <strong>bdat</strong>, since <strong>bdat</strong> is not large and therefore easy to view in its entirety.</p>
<p>There is a point worth highlighting here. Mark McGwire had a monster year in 1997, with 58 homeruns. His 1997 year, however, does not appear in our output above. Why is that? It is because he was traded mid-season from the A’s to the Cardinals. He therefore has two 1997 records in the data frame, one with 34 homeruns for the A’s, and another with 24 homeruns for the Cardinals.</p>
</div>
<div id="arrange" class="section level2">
<h2><span class="header-section-number">6.4</span> Arrange</h2>
<p>It might be nice to see the output above in a particular order, say with the most homeruns (Barry Bonds) at the top. You can use the <strong>arrange</strong> verb for this. Try the following:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bdat &lt;-<span class="st"> </span>Batting <span class="op">%&gt;%</span>
<span class="st">          </span><span class="kw">filter</span>(HR <span class="op">&gt;=</span><span class="st"> </span><span class="dv">50</span>) <span class="op">%&gt;%</span>
<span class="st">          </span><span class="kw">select</span>(playerID,yearID,teamID,HR) <span class="op">%&gt;%</span>
<span class="st">          </span><span class="kw">arrange</span>(HR)

bdat</code></pre></div>
<pre><code>##     playerID yearID teamID HR
## 1   foxxji01   1938    BOS 50
## 2  belleal01   1995    CLE 50
## 3  anderbr01   1996    BAL 50
## 4  vaughgr01   1998    SDN 50
## 5   sosasa01   2000    CHN 50
## 6  fieldpr01   2007    MIL 50
## 7  kinerra01   1947    PIT 51
## 8   mizejo01   1947    NY1 51
## 9   mayswi01   1955    NY1 51
## 10 fieldce01   1990    DET 51
## 11 jonesan01   2005    ATL 51
## 12 mantlmi01   1956    NYA 52
## 13  mayswi01   1965    SFN 52
## 14 fostege01   1977    CIN 52
## 15 mcgwima01   1996    OAK 52
## 16 rodrial01   2001    TEX 52
## 17 thomeji01   2002    CLE 52
## 18 davisch02   2013    BAL 53
## 19  ruthba01   1920    NYA 54
## 20  ruthba01   1928    NYA 54
## 21 kinerra01   1949    PIT 54
## 22 mantlmi01   1961    NYA 54
## 23 ortizda01   2006    BOS 54
## 24 rodrial01   2007    NYA 54
## 25 bautijo02   2010    TOR 54
## 26 wilsoha01   1930    CHN 56
## 27 griffke02   1997    SEA 56
## 28 griffke02   1998    SEA 56
## 29 gonzalu01   2001    ARI 57
## 30 rodrial01   2002    TEX 57
## 31  foxxji01   1932    PHA 58
## 32 greenha01   1938    DET 58
## 33 howarry01   2006    PHI 58
## 34  ruthba01   1921    NYA 59
## 35  ruthba01   1927    NYA 60
## 36 marisro01   1961    NYA 61
## 37  sosasa01   1999    CHN 63
## 38  sosasa01   2001    CHN 64
## 39 mcgwima01   1999    SLN 65
## 40  sosasa01   1998    CHN 66
## 41 mcgwima01   1998    SLN 70
## 42 bondsba01   2001    SFN 73</code></pre>
<p>As you can see, this is almost what we want, except that we want the homeruns in descending order. You can use the <strong>desc</strong> function for this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bdat &lt;-<span class="st"> </span>Batting <span class="op">%&gt;%</span>
<span class="st">          </span><span class="kw">filter</span>(HR <span class="op">&gt;=</span><span class="st"> </span><span class="dv">50</span>) <span class="op">%&gt;%</span>
<span class="st">          </span><span class="kw">select</span>(playerID,yearID,teamID,HR) <span class="op">%&gt;%</span>
<span class="st">          </span><span class="kw">arrange</span>(<span class="kw">desc</span>(HR))

bdat</code></pre></div>
<pre><code>##     playerID yearID teamID HR
## 1  bondsba01   2001    SFN 73
## 2  mcgwima01   1998    SLN 70
## 3   sosasa01   1998    CHN 66
## 4  mcgwima01   1999    SLN 65
## 5   sosasa01   2001    CHN 64
## 6   sosasa01   1999    CHN 63
## 7  marisro01   1961    NYA 61
## 8   ruthba01   1927    NYA 60
## 9   ruthba01   1921    NYA 59
## 10  foxxji01   1932    PHA 58
## 11 greenha01   1938    DET 58
## 12 howarry01   2006    PHI 58
## 13 gonzalu01   2001    ARI 57
## 14 rodrial01   2002    TEX 57
## 15 wilsoha01   1930    CHN 56
## 16 griffke02   1997    SEA 56
## 17 griffke02   1998    SEA 56
## 18  ruthba01   1920    NYA 54
## 19  ruthba01   1928    NYA 54
## 20 kinerra01   1949    PIT 54
## 21 mantlmi01   1961    NYA 54
## 22 ortizda01   2006    BOS 54
## 23 rodrial01   2007    NYA 54
## 24 bautijo02   2010    TOR 54
## 25 davisch02   2013    BAL 53
## 26 mantlmi01   1956    NYA 52
## 27  mayswi01   1965    SFN 52
## 28 fostege01   1977    CIN 52
## 29 mcgwima01   1996    OAK 52
## 30 rodrial01   2001    TEX 52
## 31 thomeji01   2002    CLE 52
## 32 kinerra01   1947    PIT 51
## 33  mizejo01   1947    NY1 51
## 34  mayswi01   1955    NY1 51
## 35 fieldce01   1990    DET 51
## 36 jonesan01   2005    ATL 51
## 37  foxxji01   1938    BOS 50
## 38 belleal01   1995    CLE 50
## 39 anderbr01   1996    BAL 50
## 40 vaughgr01   1998    SDN 50
## 41  sosasa01   2000    CHN 50
## 42 fieldpr01   2007    MIL 50</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="install-dplyr.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="grouping.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/05-select.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
